<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:composite="http://xmlns.jcp.org/jsf/composite"
      xmlns:p="http://primefaces.org/ui">
<h:head>
    <title>::Kartu Hasil Mahasiswa::</title>
    <h:outputStylesheet library="css" name="primeflex.min.css"/>
    <h:outputStylesheet name="primeicons/primeicons.css" library="primefaces"/>
    <style>

        body .ui-datatable thead th {
            background-color: var(--bluegray-200);

        }

        div .mydiv {
            padding: 1rem;
            margin: .5rem 0 .5rem;
            border: 1px solid var(--bluegray-200);
            border-radius: 10px;
        }

        body .ui-datatable.ui-datatable-striped .ui-datatable-data > tr.ui-datatable-odd {
            background-color: var(--bluegray-100);
        }
    </style>
</h:head>
<h:body>
    <h:form id="form_messages">
        <p:growl id="messages" showDetail="true" showSummary="true"/>
    </h:form>
    <div id="container-luar" class="fixed w-full h-full top-0 left-0">
        <div id="container-dalam" class="flex bg-white h-full w-full">
            <div id="container-navigator" class="bg-cover m-1 w-15rem border-round shadow-4">
                <!--sidebar disini-->
                <ui:insert name="sidebar">
                    <ui:include src="/admin/templates/sidebar.xhtml"/>
                </ui:insert>
            </div>
            <div id="container-main" class="flex flex-column bg-white w-full m-1">
                <div id="container-header"
                     class="flex bg-blue-200 align-items-center pl-2 h-4rem mb-1 border-round shadow-4">
                    <!--Header disini-->
                    <ui:insert>
                        <ui:include src="/admin/templates/header.xhtml"/>
                    </ui:insert>
                </div>
                <div id="container-content"
                     class="flex flex-column bg-white p-2 h-full overflow-y-auto shadow-4 border-round">
                    <!--content disini-->
                    <h:form>

                        <p:inputText value="#{transkripBean.nim}" id="txt_iduser" placeholder="Masukan nim"
                                     styleClass="mr-2"/>
                        <p:commandButton value="View" process="@this txt_iduser"
                                         update="dt_nilai txt_nama txt_nim txt_kelas txt_programstudi panel_summary"
                                         action="#{transkripBean.fillNilai()}" icon="pi pi-eye" styleClass="mr-2"/>
                        <p:commandButton value="Print" icon="pi pi-print" styleClass="ui-button-success mb-2">
                            <p:printer target="panel_nilai"/>
                        </p:commandButton>

                        <p:outputPanel id="panel_nilai" style="border: 1px solid var(--bluegray-200); padding: .5rem" styleClass="border-round">
                            <div class="mydiv">
                                <p:outputLabel value="Transkrip Nilai Mahasiswa" styleClass="text-2xl"/>
                            </div>
                            <div class="mydiv">
                                <p:panelGrid columns="2" columnClasses="ui-grid-col-4 p-1, ui-grid-col-8 p-1"
                                             styleClass="mb-1 mt-1 w-30rem">

                                    <p:outputLabel for="txt_nim" value="NIM"/>
                                    <p:outputLabel id="txt_nim"
                                                   value=": #{transkripBean.nim}"/>

                                    <p:outputLabel for="txt_nama" value="Nama"/>
                                    <p:outputLabel id="txt_nama"
                                                   value=": #{transkripBean.selectedMahasiswa.namaMahasiswa}"/>

                                    <p:outputLabel for="txt_kelas" value="Kelas"/>
                                    <p:outputLabel id="txt_kelas"
                                                   value=": #{transkripBean.selectedMahasiswa.user.statusMahasiswa.kodeKelas.namaKelas}"/>

                                    <p:outputLabel for="txt_kelas" value="Program Studi"/>
                                    <p:outputLabel id="txt_programstudi"
                                                   value=": #{transkripBean.selectedMahasiswa.programStudi.namaProgramstudi}"/>

                                </p:panelGrid>
                            </div>
                            <p:dataTable value="#{transkripBean.mhsNilais}" var="varMhsNilai" rowIndexVar="idx"
                                         id="dt_nilai" styleClass="border-1 border-bluegray-200 border-round p-1"
                                         tableStyleClass="w-auto" stripedRows="true" draggableColumns="true">
                                <p:column headerText="No" styleClass="p-1">
                                    <p:outputLabel value="#{idx+1}"/>
                                </p:column>
                                <p:column headerText="Kode Matkul" styleClass="p-1">
                                    <p:outputLabel
                                            value="#{varMhsNilai.krsMahasiswa.skedul.idMatakuliah.kodeMatakuliah}"/>
                                </p:column>
                                <p:column headerText="Mata Kuliah" styleClass="p-1">
                                    <p:outputLabel
                                            value="#{varMhsNilai.krsMahasiswa.skedul.idMatakuliah.namaMatakuliah}"/>
                                </p:column>
                                <p:column headerText="SKS" styleClass="p-1 text-center">
                                    <p:outputLabel value="#{varMhsNilai.krsMahasiswa.skedul.idMatakuliah.sks}"/>
                                </p:column>
                                <p:columns value="#{transkripBean.jenisNilais}" var="col" headerText="#{col}"
                                           styleClass="p-1" rendered="#{false}">
                                    <p:outputLabel value="#{varMhsNilai.nilais.get(col)}">
                                        <f:convertNumber maxFractionDigits="2" minFractionDigits="2"/>
                                    </p:outputLabel>
                                </p:columns>
                                <p:column headerText="Nilai" styleClass="p-1 text-center">
                                    <p:outputLabel value="#{nilaiAdapterBean.hitung(varMhsNilai.nilais,varMhsNilai.krsMahasiswa.skedul.idSkemakrs.id)}"/>
                                </p:column>
                                <p:column headerText="Keterangan" styleClass="p-1">
                                    <p:outputLabel value="Perbaikan: #{varMhsNilai.nilais.get('perbaikan')}"
                                                   rendered="#{varMhsNilai.nilais.get('perbaikan')!=null}">
                                        <f:convertNumber minFractionDigits="2" maxFractionDigits="2"/>
                                    </p:outputLabel>
                                </p:column>
                            </p:dataTable>

                            <div class="mydiv">
                                <p:outputLabel value="Summary" styleClass="text-2xl mt-1 mb-1"/>
                                <p:panelGrid id="panel_summary" columns="2"
                                             columnClasses="ui-grid-col-9 p-1, ui-grid-col-3 p-1"
                                             styleClass="m-1 w-30rem" layout="flex">
                                    <p:outputLabel value="Jumlah matakuliah lulus"/>
                                    <p:outputLabel id="txt_matkullulus" value="#{transkripBean.countMatkulLulus}"/>

                                    <p:outputLabel value="Jumlah matakuliah tidak lulus"/>
                                    <p:outputLabel id="txt_matkulgagal" value="#{transkripBean.countMatkulGagal}"/>

                                    <p:outputLabel value="Jumlah sks"/>
                                    <p:outputLabel id="txt_jumlahsks" value="#{transkripBean.sumIpk}"/>

                                    <p:outputLabel value="IPK Sementara"/>
                                    <h:outputLabel id="txt_ipk" value="#{transkripBean.calculateIPK}">
                                        <f:convertNumber maxFractionDigits="2"/>
                                    </h:outputLabel>

                                </p:panelGrid>
                            </div>

                            <div class="mydiv">
                                <p:outputLabel value="Hanya dapat digunakan untuk kepentingan akademis di lingkungan STMIK Time"
                                styleClass="text-gray-800"/>
                            </div>
                        </p:outputPanel>
                    </h:form>
                </div>
            </div>
        </div>
    </div>
</h:body>
</html>