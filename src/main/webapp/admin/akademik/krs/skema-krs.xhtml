<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
        PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:composite="http://xmlns.jcp.org/jsf/composite"
      xmlns:p="http://primefaces.org/ui">
<h:head>
    <title>::Sistem Informasi STMIK Time::</title>
    <h:outputStylesheet library="css" name="primeflex.min.css"/>
    <h:outputStylesheet name="primeicons/primeicons.css" library="primefaces"/>
</h:head>
<h:body>
    <h:form id="form_messages">
        <p:growl id="messages" showDetail="true" showSummary="true"/>
    </h:form>
    <div id="container-luar" class="fixed w-full h-full top-0 left-0">
        <div id="container-dalam" class="flex bg-white h-full w-full">
            <div id="container-navigator" class="bg-cover m-1 w-15rem border-round shadow-4">
                <!--sidebar disini-->
                <ui:insert name="sidebar">
                    <ui:include src="/admin/templates/sidebar.xhtml"/>
                </ui:insert>
            </div>
            <div id="container-main" class="flex flex-column bg-white w-full m-1">
                <div id="container-header"
                     class="flex bg-blue-200 align-items-center pl-2 h-4rem mb-1 border-round shadow-4">
                    <!--Header disini-->
                    <ui:insert>
                        <ui:include src="/admin/templates/header.xhtml"/>
                    </ui:insert>
                </div>
                <div id="container-content"
                     class="flex flex-column flex-wrap bg-white p-2 h-full overflow-y-auto shadow-4 border-round">
                    <!--content disini-->
                    <h:form id="form_skemakrs">
                        <p:toolbar styleClass="mb-2">
                            <p:toolbarGroup>
                                <p:commandButton id="btn_tambah" value="Tambah" icon="pi pi-plus"
                                                 styleClass="ui-button-success mr-3" update=":form_tambah:panel_tambah"
                                                 oncomplete="PF('dialog_skemakrs').show()"
                                                 action="#{skemaKrsBean.tambah()}">
                                    <p:resetInput target=":form_tambah:panel_tambah"/>
                                </p:commandButton>
                            </p:toolbarGroup>
                        </p:toolbar>
                        <p:remoteCommand actionListener="#{skemaKrsBean.findAllSkemaKrs()}" autoRun="true"
                                         update="dt_skemakrs"/>
                        <p:dataTable id="dt_skemakrs" var="krs" value="#{skemaKrsBean.skemaKrsList}"
                                     paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks}
                                        {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     currentPageReportTemplate="{startRecord}-{endRecord} of {totalRecords} records"
                                     rowsPerPageTemplate="5,10,25,50,100,{ShowAll|'All'}" rows="10"
                                     paginatorPosition="bottom" paginator="true" rowSelectMode="add" reflow="true"
                                     rowKey="#{krs.id}" tableStyle="table-layout: auto">
                            <f:facet name="header">
                                <p:outputLabel value="Tabel Skema KRS"/>
                            </f:facet>
                            <p:column headerText="id">
                                <p:outputLabel value="#{krs.id}"/>
                            </p:column>
                            <p:column headerText="tahun_ajaran">
                                <p:outputLabel value="#{krs.tahunAjaran.tahun}"/>
                            </p:column>
                            <p:column headerText="semester">
                                <p:outputLabel value="#{krs.tahunAjaran.semester}"/>
                            </p:column>
                            <p:column headerText="keterangan">
                                <p:outputLabel value="#{krs.keterangan}"/>
                            </p:column>
                            <p:column headerText="aktif">
                                <p:selectBooleanButton onIcon="pi pi-check-circle" offIcon="pi pi-times-circle"
                                                       value="#{krs.aktif}">
                                    <p:ajax listener="#{skemaKrsBean.aktif(krs)}" update=":form_messages:messages"/>
                                </p:selectBooleanButton>
                            </p:column>
                            <p:column headerText="aksi">
                                <p:commandButton icon="pi pi-eye" styleClass="mr-1 ui-button-success"
                                                 oncomplete="PF('dialog_skedul').show()"
                                                 update=":form_skedul:panel_skedul" value="skedul">
                                    <f:setPropertyActionListener target="#{skedulBean.krsId}" value="#{krs.id}"/>
                                    <p:resetInput target=":form_skedul:panel_skedul"/>
                                </p:commandButton>
                                <p:commandButton icon="pi pi-pencil"
                                                 styleClass="mr-1 ui-button-warning" value="edit"/>
                                <p:commandButton icon="pi pi-user" styleClass="mr-1"
                                                 action="lihat_pengisiankrs" value="mahasiswa">
                                    <f:setPropertyActionListener target="#{lihatKrsMahasiswaBean.krsId}"
                                                                 value="#{krs.id}"/>
                                </p:commandButton>
                                <p:commandButton icon="pi pi-trash" styleClass="ui-button-danger"
                                                 action="#{skemaKrsBean.hapus()}"
                                                 update="dt_skemakrs :form_messages:messages" value="hapus">
                                    <p:confirm header="Konfirmasi" message="Apakah kamu yakin akan menghapus dokumen?"
                                               icon="pi pi-info-circle"/>
                                    <f:setPropertyActionListener target="#{skemaKrsBean.selectedSkemaKrs}"
                                                                 value="#{krs}"/>
                                </p:commandButton>
                            </p:column>
                        </p:dataTable>
                        <p:confirmDialog global="true">
                            <p:commandButton value="No" type="button" styleClass="ui-button-flat ui-confirmdialog-no"/>
                            <p:commandButton value="Yes" type="button" styleClass="ui-confirmdialog-yes"/>
                        </p:confirmDialog>
                    </h:form>

                    <p:dialog widgetVar="dialog_skemakrs" header="Skema KRS" modal="true" showEffect="fade"
                              appendTo="@(body)" fitViewport="true" id="dialog_skemakrs" style="min-width: 600px">
                        <h:form id="form_tambah">
                            <p:outputPanel styleClass="overflow-y-auto" id="panel_tambah">
                                <p:panelGrid columns="2"
                                             columnClasses="ui-grid-col-4 p-1,ui-grid-col-8 p-1"
                                             layout="grid">

                                    <p:outputLabel for="@next" value="Tahun Ajaran"/>
                                    <p:selectOneMenu value="#{skemaKrsBean.selectedSkemaKrs.tahunAjaran.id}"
                                                     required="true" styleClass="w-full">
                                        <f:selectItem itemLabel="Pilih tahun ajaran" itemValue="#{null}"/>
                                        <f:selectItems value="#{tahunAjaranBean.findAllTahunAjaran()}" var="tahunAjaran"
                                                       itemValue="#{tahunAjaran.id}"
                                                       itemLabel="#{tahunAjaran.tahun}(#{tahunAjaran.semester})"/>
                                    </p:selectOneMenu>

                                    <p:outputLabel for="@next" value="Aktif"/>
                                    <p:selectOneButton value="#{skemaKrsBean.selectedSkemaKrs.aktif}"
                                                       styleClass="w-full">
                                        <f:selectItem itemLabel="aktif" itemValue="true"/>
                                        <f:selectItem itemLabel="non-aktif" itemValue="false"/>
                                    </p:selectOneButton>

                                    <p:outputLabel for="@next" value="Keterangan"/>
                                    <p:inputTextarea value="#{skemaKrsBean.selectedSkemaKrs.keterangan}"
                                                     styleClass="w-full"/>

                                    <p:outputLabel/>
                                    <f:facet name="footer">
                                        <div style="text-align: right">
                                            <p:commandButton value="Simpan" styleClass="mr-1" icon="pi pi-save"
                                                             action="#{skemaKrsBean.simpan()}"
                                                             update=":form_skemakrs:dt_skemakrs form_messages:messages"
                                                             oncomplete="PF('dialog_skemakrs').hide()"/>
                                            <p:commandButton value="Batal" icon="pi pi-times"
                                                             oncomplete="PF('dialog_skemakrs').hide()"/>
                                        </div>
                                    </f:facet>

                                </p:panelGrid>
                            </p:outputPanel>
                        </h:form>
                    </p:dialog>

                    <ui:insert name="skedul">
                        <ui:include src="skedul.xhtml"/>
                    </ui:insert>
                </div>
            </div>
        </div>
    </div>
</h:body>
</html>