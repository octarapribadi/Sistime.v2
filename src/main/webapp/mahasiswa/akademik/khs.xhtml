<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
        PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:composite="http://xmlns.jcp.org/jsf/composite"
      xmlns:p="http://primefaces.org/ui">
<h:head>
    <title>::Sistem Informasi STMIK Time::</title>
    <h:outputStylesheet library="css" name="primeflex.min.css"/>
    <h:outputStylesheet name="primeicons/primeicons.css" library="primefaces"/>
</h:head>
<h:body>
    <h:form id="form_messages">
        <p:growl id="messages" showDetail="true" showSummary="true"/>
    </h:form>
    <div id="container-luar" class="fixed w-full h-full top-0 left-0">
        <div id="container-dalam" class="flex bg-white h-full w-full">
            <div id="container-navigator" class="bg-cover m-1 w-15rem border-round shadow-4">
                <!--sidebar disini-->
                <ui:insert name="sidebar">
                    <ui:include src="/mahasiswa/templates/sidebar.xhtml"/>
                </ui:insert>
            </div>
            <div id="container-main" class="flex flex-column bg-white w-full m-1">
                <div id="container-header"
                     class="flex bg-blue-200 align-items-center pl-2 h-4rem mb-1 border-round shadow-4">
                    <!--Header disini-->
                    <ui:insert>
                        <ui:include src="/mahasiswa/templates/header.xhtml"/>
                    </ui:insert>
                </div>
                <div id="container-content"
                     class="flex flex-column bg-white p-2 h-full overflow-y-auto shadow-4 border-round">
                    <!--content disini-->
                    <p:outputLabel value="Kartu Hasil Studi (KHS) Mahasiswa" styleClass="text-2xl font-bold mb-2"/>
                    <h:form id="form_khs">
                        <p:remoteCommand process="@this" update="dt_semester" autoRun="true"
                                         action="#{khsMahasiswaBean.findNilaiByIdUser(sessionBean.id)}"/>

                        <p:remoteCommand process="@this" update="dt_semester" autoRun="true"
                                         action="#{khsMahasiswaBean.findDistinctSemesterFromListNilai()}"/>
                        <p:dataTable id="dt_semester" value="#{khsMahasiswaBean.tabelSemesters}"
                                     var="sem" rowIndexVar="idx" tableStyle="width:auto;">
                            <p:column headerText="No" styleClass="w-4rem">
                                <h:outputText value="#{idx+1}"/>
                            </p:column>
                            <p:column headerText="Tahun Ajaran" styleClass="w-8rem">
                                <h:outputText value="#{sem.tahunAjaran}_#{sem.tahunAjaran+1}"/>
                            </p:column>
                            <p:column headerText="Semester" styleClass="w-8rem">
                                <h:outputText value="#{sem.semester}"/>
                            </p:column>
                            <p:column headerText="IPK Semester" styleClass="w-8rem p-1">
                                <h:outputText value="#{khsMahasiswaBean.generateIPKBySemester(sem.semester)}">
                                    <f:convertNumber maxFractionDigits="2"/>
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Aksi" styleClass="w-8rem">
                                <p:commandButton styleClass="rounded-button mr-1 ui-button-success" icon="pi pi-eye"
                                                 onclick="PF('dialog_khs').show()"
                                                 action="#{khsMahasiswaBean.generateNilaiKeteranganBySemester(sem.semester)}"
                                                 update=":form_lihatkhs:dt_khs"/>
                                <p:commandButton styleClass="rounded-button" icon="pi pi-print"/>
                            </p:column>
                        </p:dataTable>
                    </h:form>
                    <p:dialog modal="true" appendTo="@(body)" header="Kartu Hasil Studi" resizable="true"
                              widgetVar="dialog_khs" fitViewport="true" style="min-width: 500px;">
                        <h:form id="form_lihatkhs">
                            <p:dataTable id="dt_khs" value="#{khsMahasiswaBean.nilaiKeterangans}"
                                         var="nilai" rowIndexVar="idx" tableStyle="width: auto">
                                <p:column headerText="No">
                                    <h:outputText value="#{idx+1}"/>
                                </p:column>
                                <p:column headerText="Kode Matakuliah">
                                    <h:outputText
                                            value="#{nilai.nilaiPerSemester.krsMahasiswa.skedul.idMatakuliah.kodeMatakuliah}"/>
                                </p:column>
                                <p:column headerText="Matakuliah">
                                    <h:outputText
                                            value="#{nilai.nilaiPerSemester.krsMahasiswa.skedul.idMatakuliah.namaMatakuliah}"/>
                                </p:column>
                                <p:column headerText="SKS">
                                    <h:outputText
                                            value="#{nilai.nilaiPerSemester.krsMahasiswa.skedul.idMatakuliah.sks}"/>
                                </p:column>
                                <p:column headerText="Absensi">
                                    <h:outputText value="#{nilai.nilaiPerSemester.absensi}"/>
                                </p:column>
                                <p:column headerText="Tugas">
                                    <h:outputText value="#{nilai.nilaiPerSemester.tugas}"/>
                                </p:column>
                                <p:column headerText="UTS">
                                    <h:outputText value="#{nilai.nilaiPerSemester.uts}"/>
                                </p:column>
                                <p:column headerText="UAS">
                                    <h:outputText value="#{nilai.nilaiPerSemester.uas}"/>
                                </p:column>
                                <p:column headerText="Total Nilai">
                                    <h:outputText value="#{nilai.nilaiAngka}">
                                        <f:convertNumber pattern="#0.00"/>
                                    </h:outputText>
                                </p:column>
                                <p:column headerText="Nilai Huruf">
                                    <h:outputText value="#{nilai.nilaiHuruf}"/>
                                </p:column>
                                <f:facet name="footer">
                                    <p:outputLabel value="IPK: "/>
                                    <p:outputLabel value="#{khsMahasiswaBean.generateIPKByNilaiKeterangans()}"
                                                   styleClass="font-bold">
                                        <f:convertNumber maxFractionDigits="2"/>
                                    </p:outputLabel>
                                </f:facet>
                            </p:dataTable>
                        </h:form>
                    </p:dialog>
                </div>
            </div>
        </div>
    </div>
</h:body>
</html>